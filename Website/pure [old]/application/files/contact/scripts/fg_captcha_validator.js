function FG_CaptchaValidator(e,t){this.captcha_ip=e;this.captcha_img=t;this.validatedCode="";this.validate=function(){if(this.validatedCode.length==0||this.validatedCode!=this.captcha_ip.value){this.ValidateOnline();return false}else{return true}};this.OnSuccess=function(){var e=this.GetResponseText();if(e=="success"){this.validatedCode=this.captcha_ip.value;if(this.captcha_ip.form.onsubmit()){this.captcha_ip.form.submit()}}else{sfm_show_error_msg(e,this.captcha_ip);document.error_disp_handler.FinalShowMsg()}};this.ValidateOnline=function(){var e=t.src;var n=this.captcha_ip.name+"="+encodeURIComponent(this.captcha_ip.value)+"&fg_validate_captcha=y";this.Init("POST",e);this.Send(n)}}function FG_Ajax(){function n(){t.OnSuccess()}function r(){t.OnFailure()}function i(){e=o();if(e){e.onreadystatechange=s}}function s(){if(4==e.readyState){if(e.status==200){n()}else{r()}}}function o(){if(window.XMLHttpRequest){return new XMLHttpRequest}else if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}else{return null}}var e=null;var t=null;this.Init=function(n,r){i();t=this;switch(arguments.length){case 2:e.open(n,r);break;case 3:e.open(n,r,arguments[2]);break}if(arguments.length>=4){e.open(n,r,arguments[2],arguments[3])}this.SetRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")};this.SetRequestHeader=function(t,n){if(e){e.setRequestHeader(t,n)}};this.Send=function(t){if(e){e.send(t)}};this.GetResponseText=function(){return e?e.responseText:null};this.OnSuccess=function(){};this.OnFailure=function(){}}FG_CaptchaValidator.prototype=new FG_Ajax